<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
 <mapper namespace="chat">
	 <select resultType="string" id="findChatIdByMemberId">
	 	select chat_id from chat where member_id = #{memberId} and status='Y'
	 </select>
	  <select resultType="string" id="findChatIdByMemberId2">
	 	select chat_id from chat where member_id = #{memberId} and status='Y'
	 </select>
	 
	<insert id="insertChatRoom">
	 	insert into chat (chat_id, member_id, receive_id)
	 	values(#{chatId}, #{memberId}, #{receiveId})
	 </insert>
	  
	  <insert id="insertChatLog">
	 	insert into chatlog(chat_no, chat_id, member_id, receive_id, msg, time)
	 	values(seq_chatlog.nextval, #{chatId}, #{memberId}, #{receiveId}, #{msg}, #{time})
	 </insert>
	 
	 <update id="updateLastCheck">
	 	update chat set lastcheck = #{time} 
	 	where chat_id = #{chatId} and member_id =#{memberId}
	 </update>
	<select id="findChatListByChatId" resultType="hashmap">
		select * 
		from chatlog
		where chat_id = #{chatId}
		order by chat_no
	 </select>
	 <select id="findRecentList" resultType="map">
	 	
		select * from chatlog where receive_id = #{memberId}
	 </select>
 </mapper>